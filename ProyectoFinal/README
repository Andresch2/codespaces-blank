# ğŸ§® Proyecto Integrador Final â€“ MiniCompiler

### Lenguaje para cÃ¡lculo de impuestos (gramÃ¡tica simple en espaÃ±ol)

---

## ğŸ‘¥ Integrantes

- **Nelson AndrÃ©s Chaves Chaves**
- **Diego Alejandro Rosero Cisneros**

**Entorno de desarrollo:** GitHub Codespaces

---

## ğŸ“‹ Â¿QuÃ© construimos?

Desarrollamos un **mini-compilador completo** que procesa un archivo fuente en un lenguaje sencillo (en espaÃ±ol) ejecutando **todas las fases de compilaciÃ³n**:

1. **AnÃ¡lisis LÃ©xico y SintÃ¡ctico** (ANTLR4)
2. **ConstrucciÃ³n del AST** (Ãrbol de Sintaxis Abstracta)
3. **AnÃ¡lisis SemÃ¡ntico** (verificaciÃ³n de tipos y sÃ­mbolos)
4. **GeneraciÃ³n de IR** (RepresentaciÃ³n Intermedia textual)
5. **GeneraciÃ³n de cÃ³digo Python**
6. **EjecuciÃ³n del programa**

Cada fase genera **artefactos** en el directorio `artifacts/<CASO>/`. Para el caso especial `input.txt`, tambiÃ©n se crean `output_program.py` y `output.txt` en la raÃ­z del proyecto.

### ğŸ”¤ CaracterÃ­sticas del lenguaje

- **Asignaciones:** `x = expr;`
- **Reglas condicionales:** `si <ID> <comparador> <expr>: <ID> = <expr>;`
- **ImpresiÃ³n:** `print(ID);`
- **Expresiones aritmÃ©ticas:** `+`, `-`, `*`, `/` con precedencia y parÃ©ntesis
- **Comparadores:** `<`, `>`, `<=`, `>=`

### ğŸ’¡ Ejemplo de cÃ³digo

```txt
base = 110000;
extra = 15000;
tasa = 0.18;

ingreso = base + extra;
impuesto = 0;

si ingreso >= 120000: impuesto = ingreso * tasa;
print(impuesto);
```

---

## ğŸ“ Estructura del proyecto

```
â”œâ”€ main.py                       # Orquestador principal: ejecuta todas las fases
â”œâ”€ run_tests.py                  # Ejecuta baterÃ­a completa de tests
â”œâ”€ gramatica.g4                  # GramÃ¡tica ANTLR (Lexer + Parser)
â”œâ”€ generated/                    # Archivos generados por ANTLR
â”œâ”€ semantic_analyzer/
â”‚  â”œâ”€ ast_nodes.py               # DefiniciÃ³n de nodos del AST
â”‚  â”œâ”€ ast_builder.py             # Constructor: Parse Tree â†’ AST
â”‚  â”œâ”€ semantic_checker.py        # VerificaciÃ³n de reglas semÃ¡nticas
â”‚  â””â”€ symbol_table.py            # Tabla de sÃ­mbolos global
â”œâ”€ codegen/
â”‚  â”œâ”€ ir.py                      # RepresentaciÃ³n Intermedia textual
â”‚  â”œâ”€ ir_emitter.py              # Generador: AST â†’ IR
â”‚  â””â”€ python_codegen.py          # Generador: IR â†’ cÃ³digo Python
â”œâ”€ tests/
â”‚  â”œâ”€ valid/                     # Casos de prueba vÃ¡lidos
â”‚  â””â”€ invalid/                   # Casos con errores (lÃ©xicos/sintÃ¡cticos/semÃ¡nticos)
â”œâ”€ viz.py                        # (Opcional) Exporta Parse Tree/AST a SVG con Graphviz
â””â”€ artifacts/                    # Directorio generado con artefactos por caso
```

---

## âš¡ Comandos rÃ¡pidos (Cheatsheet)

### 1ï¸âƒ£ Ejecutar el caso por defecto (`input.txt`)

```bash
python main.py
```

- Muestra en consola **todas las fases** de compilaciÃ³n
- Explica cualquier error encontrado
- Genera `artifacts/input/` y tambiÃ©n `./output_program.py` + `./output.txt`

### 2ï¸âƒ£ Compilar un caso especÃ­fico

```bash
python main.py --src tests/valid/V6.txt
python main.py --src tests/invalid/I5_sem.txt
```

### 3ï¸âƒ£ Ejecutar baterÃ­a completa de pruebas

```bash
python run_tests.py
```

**Comportamiento:**
- Recorre `tests/valid` y `tests/invalid`
- **Casos vÃ¡lidos:** esperan `returncode == 0`
- **Casos invÃ¡lidos:** esperan error clasificado correctamente (lÃ©xico/sintÃ¡ctico/semÃ¡ntico)

### 4ï¸âƒ£ Limpiar artefactos y empezar desde cero

```bash
rm -rf artifacts output_program.py output.txt
```

---

## âœ… Pruebas incluidas

### ğŸ“‚ `tests/valid/`
Casos que deben compilar y ejecutar correctamente.

### ğŸ“‚ `tests/invalid/`
Casos con errores intencionales para validar:

**Errores lÃ©xicos/sintÃ¡cticos:**
- Caracteres ilegales
- Falta de punto y coma (`;`)
- ParÃ©ntesis sin cerrar
- Comparador incorrecto (`<>`)
- Keyword mal escrito (`sii` en lugar de `si`)

**Errores semÃ¡nticos:**
- Uso de variable no declarada
- `print` de variable no definida
- DivisiÃ³n literal por cero
- Identificador no definido en condiciÃ³n

**Para ejecutar todas las pruebas:**

```bash
python run_tests.py
```

---

## â“ FAQ - Preguntas frecuentes

### Â¿CÃ³mo empiezo limpio sin artefactos previos?

```bash
rm -rf artifacts output_program.py output.txt
```

### Â¿QuÃ© pasa si no tengo Graphviz instalado?

Solo se omitirÃ¡n las imÃ¡genes (`.svg`) y verÃ¡s advertencias `WARN_viz_*`. Las demÃ¡s fases funcionarÃ¡n normalmente.

**Para habilitar visualizaciones, instala Graphviz:**

**Ubuntu/Debian (Codespaces):**
```bash
sudo apt-get update && sudo apt-get install -y graphviz
```

**Windows (con winget):**
```bash
winget install -e --id Graphviz.Graphviz
```

---

## ğŸš€ Â¡Listo para usar!

Clona el repositorio, asegÃºrate de tener Python 3.x y ANTLR4, y comienza a compilar:

```bash
python main.py
```